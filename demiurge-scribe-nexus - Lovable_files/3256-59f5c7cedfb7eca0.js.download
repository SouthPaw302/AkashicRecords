try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="67364149-3b56-4aea-983e-7dbc2c356d65",e._sentryDebugIdIdentifier="sentry-dbid-67364149-3b56-4aea-983e-7dbc2c356d65")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3256],{273:(e,t,r)=>{r.d(t,{Or:()=>a,QO:()=>s,a$:()=>i,cm:()=>o,gO:()=>n});let s={all:["permissions"],get:(e,t)=>[...s.all,e,t]},n={all:["projects"],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e],sharedWithMe:()=>[...n.all,"shared"],pendingProjectInvites:()=>[...n.all,"pending-invites"],branches:e=>[...n.detail(e),"branches"],secretLinkId:e=>[...n.detail(e),"secret-link-id"],domains:e=>[...n.detail(e),"domains"],sourceCode:e=>[...n.detail(e),"source-code"],feedbackStatus:e=>[...n.detail(e),"feedback-status"],presence:e=>[...n.detail(e),"presence"],communityProjects:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"recent",r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return[...n.all,"community",e,t,r,s]},collaborators:e=>[...n.detail(e),"collaborators"],analytics:(e,t)=>[...n.detail(e),"analytics",t],analyticsTrend:e=>[...n.detail(e),"analytics-trend"],projectDetails:e=>[...n.detail(e),"details"],initialPrompt:e=>[...n.detail(e),"initial-prompt"],integrations:e=>[...n.detail(e),"integrations"],integration:(e,t)=>[...n.integrations(e),t]},a={all:["workspaces"],totalProjects:e=>[...a.all,e,"total-projects"],projects:e=>{let{workspaceId:t,userId:r,limit:s,isDraft:n=!1}=e;return[...a.detail(t),"projects",r,s,n?"draft":"published"]},membership:(e,t)=>[...a.all,e,"membership",t],memberships:(e,t)=>t?[...a.detail(e),"memberships",(null==t?void 0:t.query)||"",(null==t?void 0:t.status)||"all",(null==t?void 0:t.role)||"",(null==t?void 0:t.limit)||20,(null==t?void 0:t.offset)||0,(null==t?void 0:t.sortBy)||"joined_at",(null==t?void 0:t.sortOrder)||"desc"]:[...a.detail(e),"memberships"],detail:e=>[...a.all,e],supabaseOrganizations:(e,t)=>[...a.all,e,"supabase-organizations",t],unacceptedInvites:()=>[...a.all,"unaccepted-invites"],inviteUser:(e,t)=>[...a.all,e,"invite-user",t],workspaceRole:(e,t)=>[...a.all,e,"workspace-role",t],workspaceUsage:(e,t,r)=>[...a.all,e,"workspace-usage",t,r],workspaceUserTotalUsage:e=>[...a.all,e,"workspace-user-total-usage"],workspaceGithubInstallations:e=>[...a.all,e,"workspace-github-installations"],referralCode:(e,t)=>[...a.all,e,"referral-code",t],workspaces:e=>{let{userId:t}=e;return[...a.all,t,"workspaces"]},templates:e=>[...a.detail(e),"templates"],integrationsOAuthStatus:(e,t)=>[...a.detail(e),"integrations",{integrations:t}],integrationOAuthStatus:(e,t)=>[...a.detail(e),"integrations",t,"oauth"]},o={all:["github"],installations:()=>[...o.all,"installations"],repoAccessibility:e=>[...o.all,"repo-accessibility",e],repos:e=>[...o.all,"repos",null==e?void 0:e.account.login,null==e?void 0:e.target_type]},i={all:["users"],experimentalFeatures:()=>[...i.all,"experimental-features"],workspaces:()=>[...i.all,"workspaces"],workspace:e=>[...i.workspaces(),e],profile:e=>[...i.all,e],contributions:e=>[...i.all,"contributions",e],studentDomains:()=>[...i.all,"student-domains"],toolApprovalPreferences:()=>[...i.all,"preferences","tool-preferences"]}},1965:(e,t,r)=>{r.d(t,{L:()=>s});class s extends Error{constructor(e,t,r,s,n){super(t),this.type=e,this.details=r,this.status=s,this.traceId=n}}},2417:(e,t,r)=>{r.d(t,{G:()=>i,q:()=>o});var s=r(99289),n=r(36380),a=r(51252);let o=new n.E,i=e=>{let{children:t}=e;return(0,s.jsx)(a.Ht,{client:o,children:t})}},13534:(e,t,r)=>{function s(e){return e instanceof Error&&"number"==typeof e.status&&"data"in e&&"string"==typeof e.httpMethod}r.d(t,{NF:()=>s,uy:()=>a});class n{setResponseHandler(e){this.responseHandler=e}setErrorHandler(e){this.errorHandler=e}createUrl(e,t){let r=new URL("".concat(this.baseURL).concat(e));return t&&Object.entries(t).forEach(e=>{let[t,s]=e;null!=s&&r.searchParams.append(t,s)}),r.toString()}createRequestOptions(e,t,r){let s={...this.defaultHeaders,...(null==t?void 0:t.headers)||{}};r instanceof FormData||(s["Content-Type"]="application/json");let n={method:e,headers:s,credentials:this.withCredentials?"include":"same-origin",signal:null==t?void 0:t.signal};return void 0===r||["GET","HEAD"].includes(e)||(r instanceof FormData?n.body=r:n.body=JSON.stringify(r)),n}async processResponse(e,t){return this.responseHandler?await this.responseHandler(e,t):e}async processError(e,t){throw this.errorHandler&&(e=await this.errorHandler(e,t)),e}async request(e,t,r,s){try{let n=this.createUrl(t,null==r?void 0:r.params),a=this.createRequestOptions(e,r,s),o=await fetch(n,a);if(!o.ok){let t=Error("Request failed with status ".concat(o.status));t.response=o,t.status=o.status,t.statusText=o.statusText,t.httpMethod=e;let r=o.clone();try{t.data=await r.json()}catch(e){t.data=await o.text()}return this.processError(t,o)}if(204===o.status||"0"===o.headers.get("Content-Length"))return this.processResponse({},o);let i=await o.json();return this.processResponse(i,o)}catch(e){return this.processError(e)}}async get(e,t){return this.request("GET",e,t)}async delete(e,t,r){return this.request("DELETE",e,r,t)}async head(e,t){return this.request("HEAD",e,t)}async post(e,t,r){return this.request("POST",e,r,t)}async postMultipart(e,t,r){return this.request("POST",e,r,t)}async put(e,t,r){return this.request("PUT",e,r,t)}async patch(e,t,r){return this.request("PATCH",e,r,t)}constructor(e,t={},r=!1){this.responseHandler=null,this.errorHandler=null,this.baseURL=e,this.defaultHeaders=t,this.withCredentials=r}}function a(e){return new n(e.baseURL,e.headers,e.withCredentials)}},25276:(e,t,r)=>{r.d(t,{b:()=>h});var s=r(66394),n=r(66691);class a{get(e){return this.cacheMap[e]?this.cacheMap[e]:e}set(e,t){this.cacheMap={[e]:t}}constructor(){this.cacheMap={}}}let o=new a;async function i(e){var t;let{serverIdToken:r,refreshTokenUrl:a,checkRevoked:i}=e;if(!r)return null;let l=o.get(r),c=(0,s.i)(l),u=null!=(t=null==c?void 0:c.exp)?t:0,h=Date.now()/1e3;if(!i&&h+300<u)return l;let p=await d(a);if(!(null==p?void 0:p.idToken))throw new n.AuthError(n.AuthErrorCode.INTERNAL_ERROR,"Refresh token endpoint returned invalid response. This URL should point to endpoint exposed by the middleware and configured using refreshTokenPath option");return o.set(r,p.idToken),p.idToken}async function l(e,t,r){var s;let a=await c(e);return new n.AuthError(n.AuthErrorCode.INTERNAL_ERROR,"next-firebase-auth-edge: Internal request to ".concat(null!=(s=null==r?void 0:r.method)?s:"GET"," ").concat(t.toString()," has failed: ").concat(a))}function c(e){let t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")?e.json():e.text()}async function d(e,t){let r=await fetch(e,{...t,headers:{...null==t?void 0:t.headers,Accept:"application/json","Content-Type":"application/json"}});if(!r.ok)throw await l(r,e,t);return c(r)}class u{setServerIdToken(e){this.serverIdToken=e,this.initialized=!0}isInitialized(){return this.initialized}async getValidToken(){if(!this.serverIdToken)return null;if(this.refreshPromise)return this.refreshPromise;try{this.refreshPromise=i({serverIdToken:this.serverIdToken,refreshTokenUrl:"/api/refresh-token"});let e=await this.refreshPromise;return this.refreshPromise=null,e}catch(e){return this.refreshPromise=null,null}}constructor(){this.serverIdToken=null,this.refreshPromise=null,this.initialized=!1}}let h=new u},33256:(e,t,r)=>{r.d(t,{P:()=>b,g:()=>k});var s=r(99490),n=r(2417),a=r(40007),o=r(25276),i=r(69147),l=r(67957),c=r(273);async function*d(e){yield*u(h(e))}async function*u(e){let t=null;for await(let r of e)if(!r.startsWith(":")){if(r.startsWith("event:")){t&&i.logging.error("received_sse_event_without_data",{event_type:t}),t=r.slice(6).trim();continue}if(r.startsWith("data:")){let e=r.slice(5).trimStart();try{yield{type:t,data:JSON.parse(e)}}catch(r){i.logging.error("failed_to_parse_sse_event",{error:r,event_type:t,event_data:e})}t=null}}}async function*h(e){let t=new TextDecoder,r="";for(;;){let{done:s,value:n}=await e.read(),a=(r+=t.decode(n,{stream:!s})).split(/\n+/);for(let e of(r=a.pop()||"",a))yield e;if(s){r&&(yield r);break}}}var p=r(1965),g=r(34936),f=r(13534),y=r(42676),m=r(69784);function v(e,t){return(0,f.uy)({baseURL:t,headers:e?{Authorization:"Bearer ".concat(e)}:void 0,withCredentials:!0})}class w{async getApi(){if(!o.b.isInitialized())return await new Promise(e=>setTimeout(e,50)),this.getApi();let e=await o.b.getValidToken();e||(0,y.v)("Tried to get API with no valid ID token",{error:Error("Tried to get API with no valid ID token"),severity:l.$.ERROR});let t=v(e,this.baseURL);return t.setResponseHandler((e,t)=>{if(t.headers.get("Lovable-Cachebuster")){let e=new CustomEvent("lovable-cachebuster");document.dispatchEvent(e)}return e}),t.setErrorHandler((e,t)=>{if(null==t?void 0:t.headers.get("Lovable-Cachebuster")){let e=new CustomEvent("lovable-cachebuster");document.dispatchEvent(e)}if(e&&"object"==typeof e&&"status"in e){if(401===e.status){let e=window.location.pathname;a.y.emitAuthError(e)}403===e.status&&n.q.invalidateQueries({queryKey:c.QO.all})}return Promise.reject((0,g.yO)(e))}),t}async get(e,t){return(await this.getApi()).get(e,t)}async delete(e,t,r){return(await this.getApi()).delete(e,t,r)}async post(e,t,r){return(await this.getApi()).post(e,t,r)}async put(e,t,r){return(await this.getApi()).put(e,t,r)}async patch(e,t,r){return(await this.getApi()).patch(e,t,r)}async head(e,t){return(await this.getApi()).head(e,t)}async getWithStreaming(e){let{url:t,onMessage:r,params:s,signal:n,reconnectOptions:a}=e,l={initialDelayMs:1e3,maxDelayMs:1e4,backoffFactor:2,retryCount:10,...a},c=0,u=async()=>{try{let e=await o.b.getValidToken(),a="".concat(this.baseURL).concat(t);if(s&&Object.keys(s).length>0){let e=new URLSearchParams(s).toString();a+=(t.includes("?")?"&":"?")+e}let l=await fetch(a,{method:"GET",headers:{...e?{Authorization:"Bearer ".concat(e)}:{},Accept:"text/event-stream",Connection:"keep-alive","Cache-Control":"no-cache"},signal:n}),c=l.headers.get("X-Trace-Id")||void 0;if(!l.ok){let e;try{let t=await l.text(),r=l.headers.get("Content-Type")||"";if(r.includes("application/json"))try{e=JSON.parse(t)}catch(s){i.logging.error("failed_to_parse_json_response",{error:s,responseText:t,contentType:r}),e=t}else i.logging.debug("non_json_error_response",{contentType:r,responseText:t}),e=t}catch(e){i.logging.error("failed_to_parse_response_body",{error:e,status:l.status,contentType:l.headers.get("Content-Type")})}if(429===l.status)throw new m.o("We are currently under heavy load, please try again later.",429,"RATE_LIMIT_EXCEEDED",e,c);throw new m.o("Request failed",l.status,l.statusText,e,c)}let u=l.body.getReader();try{for await(let e of d(u))if("error"===e.type)throw function(e,t){var r;let s=E.safeParse(e.data);if(!s.success)return i.logging.error("failed_to_parse_server_sse_error",{parse_error:s.error,event_data:e.data,traceId:t}),new p.L(g.i4.malformed,"Failed to parse server SSE error",void 0,500,t);let n=s.data,a=null!=(r=n.traceId)?r:t;return"Request cancelled"===n.message?new m.o("Request cancelled",499,"REQUEST_CANCELLED",n,a):(i.logging.error("server_sse_error",{error:n,traceId:a}),new m.o(n.message,500,n.type,n,a))}(e,c);else try{r(e)}catch(e){i.logging.error("unhandled_error_in_message_handler",{error:e})}}catch(e){if(await u.cancel().catch(()=>{}),e instanceof Error&&"AbortError"===e.name)return;if(e instanceof m.o){if(499===e.status)return void i.logging.info("stream_connection_cancelled",{url:t});throw e}throw i.logging.error("unexpected_error_during_sse",{error:e}),e}finally{u.releaseLock()}}catch(s){var e;if(s instanceof Error&&"AbortError"===s.name)return void i.logging.info("stream_connection_aborted",{url:t});if(s instanceof m.o&&"Request cancelled"===s.message)return void i.logging.info("stream_connection_cancelled",{url:t});if(s instanceof m.o&&"RATE_LIMIT_EXCEEDED"===s.statusText)throw s;if(c>=l.retryCount)throw i.logging.error("stream_connection_max_retries_exceeded",{url:t,maxRetries:l.retryCount,error:s}),s;let r=Math.min(l.initialDelayMs*Math.pow(l.backoffFactor,c),l.maxDelayMs);return i.logging.info("stream_connection_retry",{url:t,retryCount:c+1,maxRetries:l.retryCount,delayMs:r,error:s}),await new Promise(e=>setTimeout(e,r)),c++,null==a||null==(e=a.onReconnect)||e.call(a),u()}};return u()}constructor(e){this.baseURL=e}}let E=s.Ik({type:s.Yj(),message:s.Yj(),details:s.Yj(),traceId:s.Yj().optional()});var _=r(61625);let R=new w((0,_.N)());function b(){return R}function k(){return v(null,(0,_.N)())}},34936:(e,t,r)=>{r.d(t,{Ni:()=>h,i4:()=>c,yO:()=>u});var s=r(98213),n=r(99490),a=r(67957),o=r(1965),i=r(13534),l=r(42676);let c={network:"network_error",malformed:"malformed_response"},d=n.Ik({type:n.Yj(),message:n.Yj().optional().transform(e=>e||void 0),details:n.Yj().optional().transform(e=>e||void 0)});function u(e){if((0,i.NF)(e)){var t,r,s;let n={url:null==(t=e.response)?void 0:t.url,method:e.httpMethod,status:e.status},i=(null==(s=e.response)||null==(r=s.headers)?void 0:r.get("X-Trace-Id"))||void 0;if(!e.response)return(0,l.v)("Network error",{error:e,severity:a.$.INFO,context:n}),new o.L(c.network,"Connection Error","Please check your internet connection");let u=e.data,h=d.safeParse(u);if(h.success){let t=new o.L(h.data.type,h.data.message||"",h.data.details,e.status,i);return(0,l.V)({error:t,severity:a.$.INFO,context:n}),t}return(0,l.v)("Bad error from backend",{error:e,severity:a.$.ERROR,context:{...n,error_data:u,response:e.response,zodError:h.error}}),new o.L(c.malformed,e.statusText||"",void 0,e.status,i)}return e instanceof TypeError&&/network|failed to fetch/i.test(e.message)?((0,l.v)("Native network error",{error:e,severity:a.$.INFO}),new o.L(c.network,"Connection Error","Please check your internet connection")):((0,l.v)("Unhandled error type",{error:e,severity:a.$.ERROR}),new o.L(c.malformed,""))}function h(e){e instanceof o.L?(s.oR.error(e.message||"Something went wrong",{duration:8e3,description:e.details}),e.message||(0,l.v)("User sees vague api error",{error:e,severity:a.$.ERROR})):(s.oR.error("Something went wrong",{description:"Lovable has been notified.",duration:8e3}),(0,l.v)("User sees vague error",{error:e,severity:a.$.ERROR}))}},40007:(e,t,r)=>{r.d(t,{y:()=>a});var s=r(13861);class n extends s.EventEmitter{emitAuthError(e){this.emit("auth:error",{pathname:e})}}let a=new n},42676:(e,t,r)=>{r.d(t,{V:()=>i,v:()=>l});var s=r(545),n=r(69147),a=r(67957);let o={[a.$.ERROR]:"error",[a.$.WARN]:"warn",[a.$.INFO]:"info",[a.$.DEBUG]:"debug",[a.$.TRACE]:"trace",[a.$.LOG]:"log"};function i(e){let{error:t,severity:r,context:i}=e,l={...i,errorType:t.type},c=o[r];n.logging[c]("api_error_".concat(t.type),{error:t,...l}),(r===a.$.ERROR||r===a.$.WARN)&&s.Cp(Error("API Error: ".concat(t.type)),{extra:{...t,...l}})}function l(e,t){let{error:r,severity:i,context:l}=t,c="".concat(e,": ").concat(r instanceof Error?r.message:"Weird error"),d=r instanceof Error?r:Error(c),u=o[i];n.logging[u](c,{...l,error:r}),(i===a.$.ERROR||i===a.$.WARN)&&(d.message=c,s.Cp(d,{level:i===a.$.ERROR?"error":"warning",extra:{...l,weird_error:r instanceof Error?void 0:r}}))}},61625:(e,t,r)=>{r.d(t,{N:()=>s});let s=()=>"https://lovable-api.com"},67957:(e,t,r)=>{r.d(t,{$:()=>s});var s=function(e){return e.LOG="LOG",e.TRACE="TRACE",e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({})},69147:(e,t,r)=>{r.d(t,{S:()=>u,logging:()=>g});var s=r(62276),n=r(76918),a=r(1965),o=r(69784),i=r(67957),l=r(40074);i.$.LOG,i.$.TRACE,i.$.DEBUG,i.$.INFO,i.$.WARN,i.$.ERROR,i.$.INFO;class c{static generateSessionId(){return(0,s.A)()}setSession(e){this._session={session_id:c.generateSessionId(),previous_session:this._session.session_id,project_id:e}}setUser(e){this._user=e}get session(){return this._session}get user(){return this._user}sessionForLogging(){let{session_id:e,...t}=this._session;return{session_id:e,...Object.fromEntries(Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["session_attrs_".concat(t),r]}))}}userForLogging(){return Object.fromEntries(Object.entries(this._user||{}).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["user_".concat(t),r]}))}getForLogging(){return Object.fromEntries(Object.entries({...this.sessionForLogging(),...this.userForLogging()}).filter(e=>{let[t,r]=e;return void 0!==r}))}constructor(){this._session={session_id:c.generateSessionId()}}}let d=new c,u=(0,n.vt)(e=>({metadata:d,setMetadata:t=>e({metadata:t})})),h=async(e,t)=>{var r;let s=t[0],n=null!=(r=t[1])?r:{},i=(1e9*Math.floor(Date.now()/1e3)).toString(),c=Object.entries({msg:s,...n,...d.getForLogging(),level:e}).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(JSON.stringify(r,function e(t,r){return r instanceof o.o?{error_class:"StreamedFetchError",message:r.message,status:r.status,statusText:r.statusText,response:e("response",r.response),stack:r.stack}:r instanceof a.L?{error_class:"ApiError",type:r.type,message:r.message,details:r.details,status:r.status,stack:r.stack}:r instanceof Error?{error_class:r.constructor.name,message:r.message,stack:r.stack}:r}))}).join(" "),u={streams:[{stream:{service_name:"gptengineer-app",name:"gptengineer-app",version:l.env.NEXT_PUBLIC_VERSION||"1.0.0",environment:"production",commit_sha:"$COMMIT_REF",level:e},values:[[i,c]]}]},h="https://us-central1-gpt-engineer-390607.cloudfunctions.net/pushLogsToGrafana";if(h)try{await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})}catch(e){}},p=(e,t)=>{h(e,t)},g={info:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(i.$.INFO,t)},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(i.$.DEBUG,t)},trace:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(i.$.TRACE,t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(i.$.WARN,t)},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(i.$.ERROR,t)},log:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p(i.$.LOG,t)}}},69784:(e,t,r)=>{r.d(t,{o:()=>s});class s extends Error{constructor(e,t,r,s,n){super(e),this.status=t,this.statusText=r,this.response=s,this.traceId=n}}}}]);